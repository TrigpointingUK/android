


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > TrigDetailsOSMapAdapter</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">uk.trigpointing.android.trigdetails</a>
</div>

<h1>Coverage Summary for Class: TrigDetailsOSMapAdapter (uk.trigpointing.android.trigdetails)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TrigDetailsOSMapAdapter</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/46)
  </span>
</td>
</tr>
  <tr>
    <td class="name">TrigDetailsOSMapAdapter$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TrigDetailsOSMapAdapter$OnItemClickListener</td>
  </tr>
  <tr>
    <td class="name">TrigDetailsOSMapAdapter$ViewHolder</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/24)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/52)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package uk.trigpointing.android.trigdetails;
&nbsp;
&nbsp;import android.content.Context;
&nbsp;import android.content.res.TypedArray;
&nbsp;import android.util.Log;
&nbsp;import android.view.View;
&nbsp;import android.view.ViewGroup;
&nbsp;import android.widget.ImageView;
&nbsp;import androidx.recyclerview.widget.RecyclerView;
&nbsp;import java.util.Arrays;
&nbsp;
&nbsp;import uk.trigpointing.android.R;
&nbsp;import uk.trigpointing.android.common.LazyImageLoader;
&nbsp;
&nbsp;public class TrigDetailsOSMapAdapter extends RecyclerView.Adapter&lt;TrigDetailsOSMapAdapter.ViewHolder&gt; {
&nbsp;    
&nbsp;    public interface OnItemClickListener {
&nbsp;        void onItemClick(int position);
&nbsp;    }
&nbsp;    
&nbsp;    private OnItemClickListener mClickListener;
&nbsp;    private static final String TAG = &quot;TrigDetailsOSMapAdapter&quot;;
&nbsp;    private static final String PLACEHOLDER_URL = &quot;PLACEHOLDER&quot;;
&nbsp;    
&nbsp;    private final String[] mUrls;
&nbsp;    public LazyImageLoader imageLoader;
&nbsp;	private final int mGalleryItemBackground;
&nbsp;	private final Context mContext;
&nbsp;    
<b class="nc">&nbsp;    public TrigDetailsOSMapAdapter(Context context, String[] urls) {</b>
<b class="nc">&nbsp;        mUrls=urls;</b>
<b class="nc">&nbsp;        mContext=context;</b>
<b class="nc">&nbsp;        imageLoader=new LazyImageLoader(context);</b>
&nbsp;        
<b class="nc">&nbsp;        TypedArray attr = context.obtainStyledAttributes(R.styleable.TrigpointingUK);</b>
<b class="nc">&nbsp;        mGalleryItemBackground = attr.getResourceId(R.styleable.TrigpointingUK_android_galleryItemBackground, 0);</b>
&nbsp;    }
&nbsp;    
&nbsp;    public void setOnItemClickListener(OnItemClickListener listener) {
<b class="nc">&nbsp;        mClickListener = listener;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
<b class="nc">&nbsp;        ImageView imageView = new ImageView(mContext);</b>
<b class="nc">&nbsp;        imageView.setLayoutParams(new ViewGroup.LayoutParams(300, 300));</b>
<b class="nc">&nbsp;        imageView.setScaleType(ImageView.ScaleType.FIT_XY);</b>
<b class="nc">&nbsp;        imageView.setBackgroundResource(mGalleryItemBackground);</b>
&nbsp;        
&nbsp;        // Set click listener
<b class="nc">&nbsp;        imageView.setOnClickListener(new View.OnClickListener() {</b>
&nbsp;            @Override
&nbsp;            public void onClick(View v) {
<b class="nc">&nbsp;                if (mClickListener != null) {</b>
<b class="nc">&nbsp;                    int position = (int) v.getTag();</b>
<b class="nc">&nbsp;                    mClickListener.onItemClick(position);</b>
&nbsp;                }
&nbsp;            }
&nbsp;        });
&nbsp;        
<b class="nc">&nbsp;        return new ViewHolder(imageView);</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public void onBindViewHolder(ViewHolder holder, int position) {
&nbsp;        // Set position tag for click handling
<b class="nc">&nbsp;        holder.imageView.setTag(position);</b>
&nbsp;        
<b class="nc">&nbsp;        Log.d(TAG, &quot;Loading map image at position &quot; + position + &quot;: &quot; + mUrls[position]);</b>
&nbsp;        
&nbsp;        // Handle placeholder items
<b class="nc">&nbsp;        if (PLACEHOLDER_URL.equals(mUrls[position])) {</b>
<b class="nc">&nbsp;            holder.imageView.setImageResource(R.drawable.imageloading);</b>
<b class="nc">&nbsp;            Log.d(TAG, &quot;Showing placeholder at position &quot; + position);</b>
&nbsp;        }
&nbsp;        // Check if it&#39;s a file path or URL
<b class="nc">&nbsp;        else if (mUrls[position].startsWith(&quot;/&quot;) || mUrls[position].startsWith(&quot;file://&quot;)) {</b>
&nbsp;            // Load from local file directly (bypass LazyImageLoader for local files)
<b class="nc">&nbsp;            String filePath = mUrls[position].startsWith(&quot;file://&quot;) ? </b>
<b class="nc">&nbsp;                mUrls[position].substring(7) : mUrls[position];</b>
&nbsp;            
&nbsp;            try {
<b class="nc">&nbsp;                android.graphics.Bitmap bitmap = android.graphics.BitmapFactory.decodeFile(filePath);</b>
<b class="nc">&nbsp;                if (bitmap != null) {</b>
<b class="nc">&nbsp;                    holder.imageView.setImageBitmap(bitmap);</b>
<b class="nc">&nbsp;                    Log.d(&quot;TrigDetailsOSMapAdapter&quot;, &quot;Successfully loaded local file: &quot; + filePath);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    Log.w(&quot;TrigDetailsOSMapAdapter&quot;, &quot;Failed to decode local file: &quot; + filePath);</b>
&nbsp;                    // Set a placeholder or default image
<b class="nc">&nbsp;                    holder.imageView.setImageResource(R.drawable.imageloading);</b>
&nbsp;                }
&nbsp;            } catch (Exception e) {
<b class="nc">&nbsp;                Log.e(&quot;TrigDetailsOSMapAdapter&quot;, &quot;Error loading local file: &quot; + filePath, e);</b>
<b class="nc">&nbsp;                holder.imageView.setImageResource(R.drawable.imageloading);</b>
&nbsp;            }
&nbsp;        } else {
&nbsp;            // Load from URL using LazyImageLoader (legacy support)
<b class="nc">&nbsp;            imageLoader.DisplayImage(mUrls[position], holder.imageView);</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public int getItemCount() {
<b class="nc">&nbsp;        return mUrls.length;</b>
&nbsp;    }
&nbsp;    
&nbsp;    public static class ViewHolder extends RecyclerView.ViewHolder {
&nbsp;        ImageView imageView;
&nbsp;        
&nbsp;        public ViewHolder(View itemView) {
<b class="nc">&nbsp;            super(itemView);</b>
<b class="nc">&nbsp;            imageView = (ImageView) itemView;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Update a specific position with a new URL (for progressive loading)
&nbsp;     */
&nbsp;    public void updateImageAtPosition(int position, String imagePath) {
<b class="nc">&nbsp;        if (position &gt;= 0 &amp;&amp; position &lt; mUrls.length) {</b>
<b class="nc">&nbsp;            mUrls[position] = imagePath;</b>
<b class="nc">&nbsp;            Log.d(TAG, &quot;Updated position &quot; + position + &quot; with: &quot; + imagePath);</b>
&nbsp;            // Notify adapter of change - this will trigger onBindViewHolder() for this position
<b class="nc">&nbsp;            notifyItemChanged(position);</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Get the number of placeholder items still pending
&nbsp;     */
&nbsp;    public int getPendingCount() {
<b class="nc">&nbsp;        int count = 0;</b>
<b class="nc">&nbsp;        for (String url : mUrls) {</b>
<b class="nc">&nbsp;            if (PLACEHOLDER_URL.equals(url)) {</b>
<b class="nc">&nbsp;                count++;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return count;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Create an adapter with all placeholder items initially
&nbsp;     */
&nbsp;    public static TrigDetailsOSMapAdapter createWithPlaceholders(Context context, int expectedCount) {
<b class="nc">&nbsp;        String[] placeholders = new String[expectedCount];</b>
<b class="nc">&nbsp;        Arrays.fill(placeholders, PLACEHOLDER_URL);</b>
<b class="nc">&nbsp;        return new TrigDetailsOSMapAdapter(context, placeholders);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Get the URL at a specific position
&nbsp;     */
&nbsp;    public String getUrlAtPosition(int position) {
<b class="nc">&nbsp;        if (position &gt;= 0 &amp;&amp; position &lt; mUrls.length) {</b>
<b class="nc">&nbsp;            return mUrls[position];</b>
&nbsp;        }
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-08-25 13:52</div>
</div>
</body>
</html>
