


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > FilterFoundActivity</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">uk.trigpointing.android.filter</a>
</div>

<h1>Coverage Summary for Class: FilterFoundActivity (uk.trigpointing.android.filter)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">FilterFoundActivity</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/68)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package uk.trigpointing.android.filter;
&nbsp;
&nbsp;import android.content.Intent;
&nbsp;import android.content.SharedPreferences;
&nbsp;import android.content.SharedPreferences.Editor;
&nbsp;import android.os.Bundle;
&nbsp;import androidx.localbroadcastmanager.content.LocalBroadcastManager;
&nbsp;import androidx.preference.PreferenceManager;
&nbsp;import android.util.Log;
&nbsp;import android.view.MenuItem;
&nbsp;import android.widget.RadioButton;
&nbsp;import android.widget.RadioGroup;
&nbsp;import uk.trigpointing.android.common.BaseActivity;
&nbsp;
&nbsp;import uk.trigpointing.android.R;
&nbsp;
<b class="nc">&nbsp;public class FilterFoundActivity extends BaseActivity {</b>
&nbsp;    private static final String TAG = &quot;FilterFoundActivity&quot;;
&nbsp;    private SharedPreferences mPrefs;
&nbsp;    private RadioGroup mFilterRadio;
&nbsp;    
&nbsp;    @Override
&nbsp;    protected void onCreate(Bundle savedInstanceState) {
<b class="nc">&nbsp;        super.onCreate(savedInstanceState);</b>
<b class="nc">&nbsp;        setContentView(R.layout.filter_found);</b>
&nbsp;
<b class="nc">&nbsp;        mPrefs = PreferenceManager.getDefaultSharedPreferences(this);</b>
<b class="nc">&nbsp;        mFilterRadio = findViewById(R.id.filterRadio);</b>
&nbsp;
&nbsp;        // Enable back button in action bar
<b class="nc">&nbsp;        if (getSupportActionBar() != null) {</b>
<b class="nc">&nbsp;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Load current selection
<b class="nc">&nbsp;        loadCurrentSelection();</b>
&nbsp;    }
&nbsp;
&nbsp;    private void loadCurrentSelection() {
<b class="nc">&nbsp;        int currentRadio = mPrefs.getInt(Filter.FILTERRADIO, 0);</b>
&nbsp;        
&nbsp;        // Map the stored value to the correct radio button
<b class="nc">&nbsp;        int radioId = R.id.filterAll; // Default</b>
<b class="nc">&nbsp;        switch (currentRadio) {</b>
<b class="nc">&nbsp;            case 0: radioId = R.id.filterAll; break;</b>
<b class="nc">&nbsp;            case 1: radioId = R.id.filterLogged; break;</b>
<b class="nc">&nbsp;            case 2: radioId = R.id.filterNotLogged; break;</b>
<b class="nc">&nbsp;            case 3: radioId = R.id.filterMarked; break;</b>
<b class="nc">&nbsp;            case 4: radioId = R.id.filterUnsynced; break;</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        mFilterRadio.check(radioId);</b>
<b class="nc">&nbsp;        Log.i(TAG, &quot;Loaded filter radio: &quot; + currentRadio + &quot; -&gt; &quot; + radioId);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    protected void onPause() {
<b class="nc">&nbsp;        Log.i(TAG, &quot;onPause&quot;);</b>
<b class="nc">&nbsp;        saveFilterState();</b>
<b class="nc">&nbsp;        super.onPause();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    protected void onStop() {
<b class="nc">&nbsp;        Log.i(TAG, &quot;onStop&quot;);</b>
&nbsp;        // Save state in onStop as well to ensure synchronization
<b class="nc">&nbsp;        saveFilterState();</b>
<b class="nc">&nbsp;        super.onStop();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    protected void onDestroy() {
<b class="nc">&nbsp;        Log.i(TAG, &quot;onDestroy&quot;);</b>
&nbsp;        // Save state in onDestroy as final backup
<b class="nc">&nbsp;        saveFilterState();</b>
<b class="nc">&nbsp;        super.onDestroy();</b>
&nbsp;    }
&nbsp;
&nbsp;    private void saveFilterState() {
<b class="nc">&nbsp;        if (mPrefs == null || mFilterRadio == null) return;</b>
&nbsp;        
<b class="nc">&nbsp;        Editor editor = mPrefs.edit();</b>
&nbsp;        
&nbsp;        // Get the correct radio button value based on the checked ID
<b class="nc">&nbsp;        int filterRadio = 0; // Default to &quot;All&quot;</b>
<b class="nc">&nbsp;        int checkedId = mFilterRadio.getCheckedRadioButtonId();</b>
<b class="nc">&nbsp;        Log.i(TAG, &quot;saveFilterState: Checked radio button ID: &quot; + checkedId);</b>
&nbsp;        
<b class="nc">&nbsp;        if (checkedId == R.id.filterAll) {</b>
<b class="nc">&nbsp;            filterRadio = 0;</b>
<b class="nc">&nbsp;        } else if (checkedId == R.id.filterLogged) {</b>
<b class="nc">&nbsp;            filterRadio = 1;</b>
<b class="nc">&nbsp;        } else if (checkedId == R.id.filterNotLogged) {</b>
<b class="nc">&nbsp;            filterRadio = 2;</b>
<b class="nc">&nbsp;        } else if (checkedId == R.id.filterMarked) {</b>
<b class="nc">&nbsp;            filterRadio = 3;</b>
<b class="nc">&nbsp;        } else if (checkedId == R.id.filterUnsynced) {</b>
<b class="nc">&nbsp;            filterRadio = 4;</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        editor.putInt(Filter.FILTERRADIO, filterRadio);</b>
<b class="nc">&nbsp;        Log.i(TAG, &quot;saveFilterState: Saving filter radio: &quot; + filterRadio);</b>
&nbsp;        
&nbsp;        // Get text of selected radiobox item
<b class="nc">&nbsp;        RadioButton btnSelected = findViewById(checkedId);</b>
<b class="nc">&nbsp;        if (btnSelected != null) {</b>
<b class="nc">&nbsp;            String radioText = btnSelected.getText().toString();</b>
<b class="nc">&nbsp;            editor.putString(Filter.FILTERRADIOTEXT, radioText);</b>
<b class="nc">&nbsp;            Log.i(TAG, &quot;saveFilterState: Saving filter radio text: &#39;&quot; + radioText + &quot;&#39;&quot;);</b>
&nbsp;        }
&nbsp;        
&nbsp;        // Also update the leaflet map filter preference for synchronization
<b class="nc">&nbsp;        String leafletFilterValue = convertToLeafletFilterValue(filterRadio);</b>
<b class="nc">&nbsp;        editor.putString(&quot;leaflet_filter_found&quot;, leafletFilterValue);</b>
<b class="nc">&nbsp;        Log.i(TAG, &quot;saveFilterState: Syncing with leaflet filter: &quot; + leafletFilterValue);</b>
&nbsp;    
&nbsp;        // Save to prefs
<b class="nc">&nbsp;        editor.apply();</b>
&nbsp;        
&nbsp;        // Broadcast the filter change to notify other components
<b class="nc">&nbsp;        Intent filterChangeIntent = new Intent(&quot;FILTER_FOUND_CHANGED&quot;);</b>
<b class="nc">&nbsp;        filterChangeIntent.putExtra(&quot;filter_value&quot;, leafletFilterValue);</b>
<b class="nc">&nbsp;        LocalBroadcastManager.getInstance(this).sendBroadcast(filterChangeIntent);</b>
<b class="nc">&nbsp;        Log.i(TAG, &quot;saveFilterState: Broadcasted filter change: &quot; + leafletFilterValue);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean onOptionsItemSelected(MenuItem item) {
<b class="nc">&nbsp;        if (item.getItemId() == android.R.id.home) {</b>
<b class="nc">&nbsp;            finish();</b>
<b class="nc">&nbsp;            return true;</b>
&nbsp;        }
<b class="nc">&nbsp;        return super.onOptionsItemSelected(item);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Convert the FilterFoundActivity radio values to LeafletMap filter values for synchronization
&nbsp;     */
&nbsp;    private String convertToLeafletFilterValue(int filterRadio) {
<b class="nc">&nbsp;        switch (filterRadio) {</b>
<b class="nc">&nbsp;            case 0: return &quot;all&quot;;      // filterAll</b>
<b class="nc">&nbsp;            case 1: return &quot;logged&quot;;   // filterLogged  </b>
<b class="nc">&nbsp;            case 2: return &quot;notlogged&quot;; // filterNotLogged</b>
<b class="nc">&nbsp;            case 3: return &quot;marked&quot;;   // filterMarked</b>
<b class="nc">&nbsp;            case 4: return &quot;unsynced&quot;; // filterUnsynced</b>
<b class="nc">&nbsp;            default: return &quot;all&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-08-25 13:52</div>
</div>
</body>
</html>
